---
title: "Flacc m6a - Differr + Yanocomp"
---
```{r}
library(data.table)
library(ggplot2)
```

Colour palette
```{r colour bar, echo=FALSE, fig.height=2, fig.width=13}
palette <- c(
 # Writers
  "MTA"     = "#004488",
  "VIR"  = "#009988",
  "FIP37"   = "#0077BB",
  "hiz2-4" = "#AA4499",
  "hiz2-2"    = "#CCAA22",
  "HAKAI" = "#556B2F",
  #Readers
  "ECT"     = "#EE7733",
  "CPSF30"  = "#DD3377",
  #Other
  "U2B"     = "#CC3311",
  "Col-0"    = "#888888"
)
barplot(rep(1, 10), col = palette, names.arg = names(palette), yaxt = "n")
```
Get the diff err stats for hiz2-4 vs col0
olumns of bed file are:

    chrom, start, end, name
    score: -log10 of the FDR, rounded to nearest whole number
    strand
    odds ratio: the change in the ratio of matches to mismatches in the wild type compared to the mutant with low modifications. An odds ratio > 0 indicates more modifications in the WT.
    G statistic for the comparison of pooled WT and mutant samples.
    -log10 P value for the comparison of pooled WT and mutant samples.
    -log10 FDR for the comparison of pooled WT and mutant samples.
    G statistic for the homogeneity test of mutant replicates.
    -log10 P value for the homogeneity test of mutant replicates.
    G statistic for the homogeneity test of wild type replicates.
    -log10 P value for the homogeneity test of wild type replicates.

```{r}
hiz2_4_diff_err <- fread("/Volumes/cluster/ggs_lab/mtparker/papers/flacc/flacc_nanopore/pipeline/differr/flacc_vs_col0.bed")
colnames(hiz2_4_diff_err) <- c("chrom", "start", "end", "name", "score", "strand", "odds", "G", "P", "FDR", "g_hom", "P_hom", "g_hom_c", "P_hom_c")
head(hiz2_4_diff_err)
```
Number of differentially expressed sites?
```{r}
hiz2_4_diff_err_filtered <- hiz2_4_diff_err[hiz2_4_diff_err$FDR>=1.30103]
```


